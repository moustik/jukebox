function Sound(e){this.options=e,this.options==undefined&&(this.options=new Object),this.options.swfLocation||(this.options.swfLocation="SoundBridge.swf"),Sound.id_count==undefined?Sound.id_count=1:Sound.id_count++,Sound.instances==undefined&&(Sound.instances=new Object),this.object_id="object_id_"+Sound.id_count,Sound.instances[this.object_id]=this,movie_swf=this.options.swfLocation,movie_id=this.object_id,movie_element="",movie_element+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0" width="0" height="0"',movie_element+=' id="'+movie_id+'"',movie_element+=' align="middle">',movie_element+='<param name="movie" value="'+movie_swf+'" />',movie_element+='<param name="quality" value="high" />',movie_element+='<param name="bgcolor" value="#ffffff" />',movie_element+='<param name="FlashVars" value="id='+movie_id+'"/>',movie_element+='<param name="allowScriptAccess" value="always"/>',movie_element+='<embed src="'+movie_swf+'" FlashVars="id='+movie_id+'"',movie_element+=' allowScriptAccess="always" quality="high" bgcolor="#ffffff" width="0" height="0"',movie_element+=' name="'+movie_id+'" align="middle" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" />',movie_element+="</object>";if(document.getElementById("__sound_flash__")==undefined){var t=document.createElement("div");t.id="__sound_flash__",document.body.appendChild(t)}document.getElementById("__sound_flash__").innerHTML+=movie_element}var JSON;JSON||(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();var TableKit=Class.create();TableKit.prototype={initialize:function(e,t){var n=$(e);if(n.tagName!=="TABLE")return;TableKit.register(n,Object.extend(TableKit.options,t||{})),this.id=n.id;var r=TableKit.option("sortable resizable editable",this.id);r.sortable&&TableKit.Sortable.init(n),r.resizable&&TableKit.Resizable.init(n),r.editable&&TableKit.Editable.init(n)},sort:function(e,t){TableKit.Sortable.sort(this.id,e,t)},resizeColumn:function(e,t){TableKit.Resizable.resize(this.id,e,t)},editCell:function(e,t){TableKit.Editable.editCell(this.id,e,t)}},Object.extend(TableKit,{getBodyRows:function(e){e=$(e);var t=e.id;return TableKit.tables[t].dom.rows||(TableKit.tables[t].dom.rows=e.tHead&&e.tHead.rows.length>0?$A(e.tBodies[0].rows):$A(e.rows).without(e.rows[0])),TableKit.tables[t].dom.rows},getHeaderCells:function(e,t){e||(e=$(t).up("table"));var n=e.id;return TableKit.tables[n].dom.head||(TableKit.tables[n].dom.head=$A(e.tHead&&e.tHead.rows.length>0?e.tHead.rows[e.tHead.rows.length-1].cells:e.rows[0].cells)),TableKit.tables[n].dom.head},getCellIndex:function(e){return $A(e.parentNode.cells).indexOf(e)},getRowIndex:function(e){return $A(e.parentNode.rows).indexOf(e)},getCellText:function(e,t){if(!e)return"";var n=TableKit.getCellData(e);if(t||n.refresh||!n.textContent)n.textContent=e.textContent?e.textContent:e.innerText,n.refresh=!1;return n.textContent},getCellData:function(e){var t=null;e.id||(t=$(e).up("table"),e.id=t.id+"-cell-"+TableKit._getc());var n=t?t.id:e.id.match(/(.*)-cell.*/)[1];return TableKit.tables[n].dom.cells[e.id]||(TableKit.tables[n].dom.cells[e.id]={textContent:"",htmlContent:"",active:!1}),TableKit.tables[n].dom.cells[e.id]},register:function(e,t){e.id||(e.id="tablekit-table-"+TableKit._getc());var n=e.id;TableKit.tables[n]=TableKit.tables[n]?Object.extend(TableKit.tables[n],t||{}):Object.extend({dom:{head:null,rows:null,cells:{}},sortable:!1,resizable:!1,editable:!1},t||{})},notify:function(e,t,n){TableKit.tables[t.id]&&TableKit.tables[t.id].observers&&TableKit.tables[t.id].observers[e]&&TableKit.tables[t.id].observers[e](t,n),TableKit.options.observers[e](t,n)()},isSortable:function(e){return TableKit.tables[e.id]?TableKit.tables[e.id].sortable:!1},isResizable:function(e){return TableKit.tables[e.id]?TableKit.tables[e.id].resizable:!1},isEditable:function(e){return TableKit.tables[e.id]?TableKit.tables[e.id].editable:!1},setup:function(e){Object.extend(TableKit.options,e||{})},option:function(e,t,n,r){n=n||TableKit.options,r=r||(t?TableKit.tables[t]?TableKit.tables[t]:{}:{});var i=t+e;return TableKit._opcache[i]||(TableKit._opcache[i]=$A($w(e)).inject([],function(e,t){return e.push(e[t]=r[t]||n[t]),e})),TableKit._opcache[i]},e:function(e){return e||window.event},tables:{},_opcache:{},options:{autoLoad:!0,stripe:!0,sortable:!0,resizable:!0,editable:!0,rowEvenClass:"roweven",rowOddClass:"rowodd",sortableSelector:["table.sortable"],columnClass:"sortcol",descendingClass:"sortdesc",ascendingClass:"sortasc",defaultSortDirection:1,noSortClass:"nosort",sortFirstAscendingClass:"sortfirstasc",sortFirstDecendingClass:"sortfirstdesc",resizableSelector:["table.resizable"],minWidth:10,showHandle:!0,resizeOnHandleClass:"resize-handle-active",editableSelector:["table.editable"],formClassName:"editable-cell-form",noEditClass:"noedit",editAjaxURI:"/",editAjaxOptions:{},observers:{onSortStart:function(){},onSort:function(){},onSortEnd:function(){},onResizeStart:function(){},onResize:function(){},onResizeEnd:function(){},onEditStart:function(){},onEdit:function(){},onEditEnd:function(){}}},_c:0,_getc:function(){return TableKit._c+=1},unloadTable:function(e){e=$(e);if(!TableKit.tables[e.id])return;var t=TableKit.getHeaderCells(e),n=TableKit.option("sortable resizable editable noSortClass descendingClass ascendingClass columnClass sortFirstAscendingClass sortFirstDecendingClass",e.id);t.each(function(e){e=$(e),n.sortable&&(e.hasClassName(n.noSortClass)||(Event.stopObserving(e,"mousedown",TableKit.Sortable._sort),e.removeClassName(n.columnClass),e.removeClassName(n.sortFirstAscendingClass),e.removeClassName(n.sortFirstDecendingClass),e.hasClassName(n.ascendingClass)?(e.removeClassName(n.ascendingClass),e.addClassName(n.sortFirstAscendingClass)):e.hasClassName(n.descendingClass)&&(e.removeClassName(n.descendingClass),e.addClassName(n.sortFirstDecendingClass)))),n.resizable&&(Event.stopObserving(e,"mouseover",TableKit.Resizable.initDetect),Event.stopObserving(e,"mouseout",TableKit.Resizable.killDetect))});if(n.editable){Event.stopObserving(e.tBodies[0],"click",TableKit.Editable._editCell);for(var r in TableKit.tables[e.id].dom.cells)if(TableKit.tables[e.id].dom.cells[r].active){var i=$(r),s=TableKit.Editable.getCellEditor(i);s.cancel(i)}}TableKit.tables[e.id].dom={head:null,rows:null,cells:{}}},reloadTable:function(e){e=$(e),TableKit.unloadTable(e);var t=TableKit.option("sortable resizable editable",e.id);t.sortable&&TableKit.Sortable.init(e),t.resizable&&TableKit.Resizable.init(e),t.editable&&TableKit.Editable.init(e)},reload:function(){for(var e in TableKit.tables)TableKit.reloadTable(e)},load:function(){TableKit.options.autoLoad&&(TableKit.options.sortable&&$A(TableKit.options.sortableSelector).each(function(e){$$(e).each(function(e){TableKit.Sortable.init(e)})}),TableKit.options.resizable&&$A(TableKit.options.resizableSelector).each(function(e){$$(e).each(function(e){TableKit.Resizable.init(e)})}),TableKit.options.editable&&$A(TableKit.options.editableSelector).each(function(e){$$(e).each(function(e){TableKit.Editable.init(e)})}))}}),TableKit.Rows={stripe:function(e){var t=TableKit.getBodyRows(e);t.each(function(t,n){TableKit.Rows.addStripeClass(e,t,n)})},addStripeClass:function(e,t,n){e=e||t.up("table");var r=TableKit.option("rowEvenClass rowOddClass",e.id),i=(n+1)%2===0?r[0]:r[1],s=t.className.split(/\s+/),o=[];for(var u=0,a=s.length;u<a;u+=1)s[u]!==r[0]&&s[u]!==r[1]&&o.push(s[u]);o.push(i),t.className=o.join(" ")}},TableKit.Sortable={init:function(e,t){var n=$(e);if(n.tagName!=="TABLE")return;TableKit.register(n,Object.extend(t||{},{sortable:!0}));var r,i=TableKit.getHeaderCells(n),s=TableKit.option("noSortClass columnClass sortFirstAscendingClass sortFirstDecendingClass",n.id);i.each(function(e){e=$(e);if(!e.hasClassName(s.noSortClass)){Event.observe(e,"mousedown",TableKit.Sortable._sort),e.addClassName(s.columnClass);if(e.hasClassName(s.sortFirstAscendingClass)||e.hasClassName(s.sortFirstDecendingClass))r=e}}),r?r.hasClassName(s.sortFirstAscendingClass)?TableKit.Sortable.sort(n,r,1):TableKit.Sortable.sort(n,r,-1):TableKit.Rows.stripe(n)},reload:function(e){e=$(e);var t=TableKit.getHeaderCells(e),n=TableKit.option("noSortClass columnClass",e.id);t.each(function(e){e=$(e),e.hasClassName(n.noSortClass)||(Event.stopObserving(e,"mousedown",TableKit.Sortable._sort),e.removeClassName(n.columnClass))}),TableKit.Sortable.init(e)},_sort:function(e){if(TableKit.Resizable._onHandle)return;e=TableKit.e(e),Event.stop(e);var t=Event.element(e);while(!t.tagName||!t.tagName.match(/td|th/gi))t=t.parentNode;TableKit.Sortable.sort(null,t)},sort:function(e,t,n){var r;if(typeof t=="number"){if(!e||e.tagName&&e.tagName!=="TABLE")return;e=$(e),t=Math.min(e.rows[0].cells.length,t),t=Math.max(1,t),t-=1,r=e.tHead&&e.tHead.rows.length>0?$(e.tHead.rows[e.tHead.rows.length-1].cells[t]):$(e.rows[0].cells[t])}else r=$(t),e=e?$(e):r.up("table"),t=TableKit.getCellIndex(r);var i=TableKit.option("noSortClass descendingClass ascendingClass defaultSortDirection",e.id);if(r.hasClassName(i.noSortClass))return;n=n?n:i.defaultSortDirection;var s=TableKit.getBodyRows(e);if(r.hasClassName(i.ascendingClass)||r.hasClassName(i.descendingClass))s.reverse(),n=r.hasClassName(i.descendingClass)?1:-1;else{var o=TableKit.Sortable.getDataType(r,t,e),u=TableKit.Sortable.types;s.sort(function(e,r){return n*u[o].compare(TableKit.getCellText(e.cells[t]),TableKit.getCellText(r.cells[t]))})}var a=e.tBodies[0],f=TableKit.Rows;s.each(function(t,n){a.appendChild(t),f.addStripeClass(e,t,n)});var l=TableKit.getHeaderCells(null,r);$A(l).each(function(e,r){e=$(e),e.removeClassName(i.ascendingClass),e.removeClassName(i.descendingClass),t===r&&(n===1?e.addClassName(i.ascendingClass):e.addClassName(i.descendingClass))})},types:{},detectors:[],addSortType:function(){$A(arguments).each(function(e){TableKit.Sortable.types[e.name]=e})},getDataType:function(e,t,n){e=$(e),t=t||t===0?t:TableKit.getCellIndex(e);var r=TableKit.Sortable._coltypecache,i=r[n.id]?r[n.id]:r[n.id]={};if(!i[t]){var s=!1;e.id&&TableKit.Sortable.types[e.id]&&(s=e.id),s||(s=$w(e.className).detect(function(e){return TableKit.Sortable.types[e]?!0:!1}));if(!s){var o=TableKit.getBodyRows(n);e=o[0].cells[t],s=TableKit.Sortable.detectors.detect(function(t){return TableKit.Sortable.types[t].detect(TableKit.getCellText(e))})}i[t]=s}return i[t]},_coltypecache:{}},TableKit.Sortable.detectors=$A($w("date-iso date date-eu date-au time currency datasize number casesensitivetext text")),TableKit.Sortable.Type=Class.create(),TableKit.Sortable.Type.prototype={initialize:function(e,t){this.name=e,t=Object.extend({normal:function(e){return e},pattern:/.*/},t||{}),this.normal=t.normal,this.pattern=t.pattern,t.compare&&(this.compare=t.compare),t.detect&&(this.detect=t.detect)},compare:function(e,t){return TableKit.Sortable.Type.compare(this.normal(e),this.normal(t))},detect:function(e){return this.pattern.test(e)}},TableKit.Sortable.Type.compare=function(e,t){return e<t?-1:e===t?0:1},TableKit.Sortable.addSortType(new TableKit.Sortable.Type("number",{pattern:/^[-+]?[\d]*\.?[\d]+(?:[eE][-+]?[\d]+)?/,normal:function(e){return e=parseFloat(e.replace(/^.*?([-+]?[\d]*\.?[\d]+(?:[eE][-+]?[\d]+)?).*$/,"$1")),isNaN(e)?0:e}}),new TableKit.Sortable.Type("text",{normal:function(e){return e?e.toLowerCase():""}}),new TableKit.Sortable.Type("casesensitivetext",{pattern:/^[A-Z]+$/}),new TableKit.Sortable.Type("datasize",{pattern:/^[-+]?[\d]*\.?[\d]+(?:[eE][-+]?[\d]+)?\s?[k|m|g|t]b$/i,normal:function(e){var t=e.match(/^([-+]?[\d]*\.?[\d]+([eE][-+]?[\d]+)?)\s?([k|m|g|t]?b)?/i),n=t[1]?Number(t[1]).valueOf():0,r=t[3]?t[3].substr(0,1).toLowerCase():"",i=n;switch(r){case"k":i=n*1024;break;case"m":i=n*1024*1024;break;case"g":i=n*1024*1024*1024;break;case"t":i=n*1024*1024*1024*1024}return i}}),new TableKit.Sortable.Type("date-au",{pattern:/^\d{2}\/\d{2}\/\d{4}\s?(?:\d{1,2}\:\d{2}(?:\:\d{2})?\s?[a|p]?m?)?/i,normal:function(e){if(!this.pattern.test(e))return 0;var t=e.match(/^(\d{2})\/(\d{2})\/(\d{4})\s?(?:(\d{1,2})\:(\d{2})(?:\:(\d{2}))?\s?([a|p]?m?))?/i),n=t[3],r=parseInt(t[2],10)-1,i=t[1],s=t[4]?t[4]:0;if(t[7]){var o=parseInt(t[4],10);t[7].toLowerCase().indexOf("p")!==-1?s=o<12?o+12:o:t[7].toLowerCase().indexOf("a")!==-1&&(s=o<12?o:0)}var u=t[5]?t[5]:0,a=t[6]?t[6]:0;return(new Date(n,r,i,s,u,a,0)).valueOf()}}),new TableKit.Sortable.Type("date-us",{pattern:/^\d{2}\/\d{2}\/\d{4}\s?(?:\d{1,2}\:\d{2}(?:\:\d{2})?\s?[a|p]?m?)?/i,normal:function(e){if(!this.pattern.test(e))return 0;var t=e.match(/^(\d{2})\/(\d{2})\/(\d{4})\s?(?:(\d{1,2})\:(\d{2})(?:\:(\d{2}))?\s?([a|p]?m?))?/i),n=t[3],r=parseInt(t[1],10)-1,i=t[2],s=t[4]?t[4]:0;if(t[7]){var o=parseInt(t[4],10);t[7].toLowerCase().indexOf("p")!==-1?s=o<12?o+12:o:t[7].toLowerCase().indexOf("a")!==-1&&(s=o<12?o:0)}var u=t[5]?t[5]:0,a=t[6]?t[6]:0;return(new Date(n,r,i,s,u,a,0)).valueOf()}}),new TableKit.Sortable.Type("date-eu",{pattern:/^\d{2}-\d{2}-\d{4}/i,normal:function(e){if(!this.pattern.test(e))return 0;var t=e.match(/^(\d{2})-(\d{2})-(\d{4})/),n=t[3],r=parseInt(t[2],10)-1,i=t[1];return(new Date(n,r,i)).valueOf()}}),new TableKit.Sortable.Type("date-iso",{pattern:/[\d]{4}-[\d]{2}-[\d]{2}(?:T[\d]{2}\:[\d]{2}(?:\:[\d]{2}(?:\.[\d]+)?)?(Z|([-+][\d]{2}:[\d]{2})?)?)?/,normal:function(e){if(!this.pattern.test(e))return 0;var t=e.match(/([\d]{4})(-([\d]{2})(-([\d]{2})(T([\d]{2}):([\d]{2})(:([\d]{2})(\.([\d]+))?)?(Z|(([-+])([\d]{2}):([\d]{2})))?)?)?)?/),n=0,r=new Date(t[1],0,1);t[3]&&r.setMonth(t[3]-1),t[5]&&r.setDate(t[5]),t[7]&&r.setHours(t[7]),t[8]&&r.setMinutes(t[8]),t[10]&&r.setSeconds(t[10]),t[12]&&r.setMilliseconds(Number("0."+t[12])*1e3),t[14]&&(n=Number(t[16])*60+Number(t[17]),n*=t[15]==="-"?1:-1),n-=r.getTimezoneOffset();if(n!==0){var i=Number(r)+n*60*1e3;r.setTime(Number(i))}return r.valueOf()}}),new TableKit.Sortable.Type("date",{pattern:/^(?:sun|mon|tue|wed|thu|fri|sat)\,\s\d{1,2}\s(?:jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)\s\d{4}(?:\s\d{2}\:\d{2}(?:\:\d{2})?(?:\sGMT(?:[+-]\d{4})?)?)?/i,compare:function(e,t){return e&&t?TableKit.Sortable.Type.compare(new Date(e),new Date(t)):TableKit.Sortable.Type.compare(e?1:0,t?1:0)}}),new TableKit.Sortable.Type("time",{pattern:/^\d{1,2}\:\d{2}(?:\:\d{2})?(?:\s[a|p]m)?$/i,compare:function(e,t){var n=new Date,r=n.getMonth()+"/"+n.getDate()+"/"+n.getFullYear()+" ";return TableKit.Sortable.Type.compare(new Date(r+e),new Date(r+t))}}),new TableKit.Sortable.Type("currency",{pattern:/^[$����]/,normal:function(e){return e?parseFloat(e.replace(/[^-\d\.]/g,"")):0}})),TableKit.Resizable={init:function(e,t){var n=$(e);if(n.tagName!=="TABLE")return;TableKit.register(n,Object.extend(t||{},{resizable:!0}));var r=TableKit.getHeaderCells(n);r.each(function(e){e=$(e),e.id!="actions"&&(Event.observe(e,"mouseover",TableKit.Resizable.initDetect),Event.observe(e,"mouseout",TableKit.Resizable.killDetect))})},resize:function(e,t,n){var r;if(typeof t=="number"){if(!e||e.tagName&&e.tagName!=="TABLE")return;e=$(e),t=Math.min(e.rows[0].cells.length,t),t=Math.max(1,t),t-=1,r=e.tHead&&e.tHead.rows.length>0?$(e.tHead.rows[e.tHead.rows.length-1].cells[t]):$(e.rows[0].cells[t])}else r=$(t),e=e?$(e):r.up("table"),t=TableKit.getCellIndex(r);var i=parseInt(r.getStyle("paddingLeft"),10)+parseInt(r.getStyle("paddingRight"),10);n=Math.max(n-i,TableKit.option("minWidth",e.id)[0]),r.setStyle({width:n+"px"})},initDetect:function(e){e=TableKit.e(e);var t=Event.element(e);Event.observe(t,"mousemove",TableKit.Resizable.detectHandle),Event.observe(t,"mousedown",TableKit.Resizable.startResize)},detectHandle:function(e){e=TableKit.e(e);var t=Event.element(e);TableKit.Resizable.pointerPos(t,Event.pointerX(e),Event.pointerY(e))?(t.addClassName(TableKit.option("resizeOnHandleClass",t.up("table").id)[0]),TableKit.Resizable._onHandle=!0):(t.removeClassName(TableKit.option("resizeOnHandleClass",t.up("table").id)[0]),TableKit.Resizable._onHandle=!1)},killDetect:function(e){e=TableKit.e(e),TableKit.Resizable._onHandle=!1;var t=Event.element(e);Event.stopObserving(t,"mousemove",TableKit.Resizable.detectHandle),Event.stopObserving(t,"mousedown",TableKit.Resizable.startResize),t.removeClassName(TableKit.option("resizeOnHandleClass",t.up("table").id)[0])},startResize:function(e){e=TableKit.e(e);if(!TableKit.Resizable._onHandle)return;var t=Event.element(e);Event.stopObserving(t,"mousemove",TableKit.Resizable.detectHandle),Event.stopObserving(t,"mousedown",TableKit.Resizable.startResize),Event.stopObserving(t,"mouseout",TableKit.Resizable.killDetect),TableKit.Resizable._cell=t;var n=t.up("table");TableKit.Resizable._tbl=n,TableKit.option("showHandle",n.id)[0]&&(TableKit.Resizable._handle=$(document.createElement("div")).addClassName("resize-handle").setStyle({top:t.cumulativeOffset()[1]+"px",left:Event.pointerX(e)+"px",height:n.getDimensions().height+"px"}),document.body.appendChild(TableKit.Resizable._handle)),Event.observe(document,"mousemove",TableKit.Resizable.drag),Event.observe(document,"mouseup",TableKit.Resizable.endResize),Event.stop(e)},endResize:function(e){e=TableKit.e(e);var t=TableKit.Resizable._cell;TableKit.Resizable.resize(null,t,Event.pointerX(e)-t.cumulativeOffset()[0]),Event.stopObserving(document,"mousemove",TableKit.Resizable.drag),Event.stopObserving(document,"mouseup",TableKit.Resizable.endResize),TableKit.option("showHandle",TableKit.Resizable._tbl.id)[0]&&$$("div.resize-handle").each(function(e){document.body.removeChild(e)}),Event.observe(t,"mouseout",TableKit.Resizable.killDetect),TableKit.Resizable._tbl=TableKit.Resizable._handle=TableKit.Resizable._cell=null,Event.stop(e)},drag:function(e){e=TableKit.e(e);if(TableKit.Resizable._handle===null)try{TableKit.Resizable.resize(TableKit.Resizable._tbl,TableKit.Resizable._cell,Event.pointerX(e)-TableKit.Resizable._cell.cumulativeOffset()[0])}catch(e){}else TableKit.Resizable._handle.setStyle({left:Event.pointerX(e)+"px"});return!1},pointerPos:function(e,t,n){var r=$(e).cumulativeOffset();return n>=r[1]&&n<r[1]+e.offsetHeight&&t>=r[0]+e.offsetWidth-5&&t<r[0]+e.offsetWidth},_onHandle:!1,_cell:null,_tbl:null,_handle:null},TableKit.Editable={init:function(e,t){var n=$(e);if(n.tagName!=="TABLE")return;TableKit.register(n,Object.extend(t||{},{editable:!0})),Event.observe(n.tBodies[0],"click",TableKit.Editable._editCell)},_editCell:function(e){e=TableKit.e(e);var t=Event.findElement(e,"td");if(!t)return!1;TableKit.Editable.editCell(null,t,null,e)},editCell:function(e,t,n,r){var i,s;if(typeof t=="number"){if(!e||e.tagName&&e.tagName!=="TABLE")return;e=$(e),t=Math.min(e.tBodies[0].rows.length,t),t=Math.max(1,t),t-=1,n=Math.min(e.rows[0].cells.length,n),n=Math.max(1,n),n-=1,s=$(e.tBodies[0].rows[t]),i=$(s.cells[n])}else i=$(r?Event.findElement(r,"td"):t),e=e&&e.tagName&&e.tagName!=="TABLE"?$(e):i.up("table"),s=i.up("tr");var o=TableKit.option("noEditClass",e.id);if(i.hasClassName(o.noEditClass))return;var u=$(TableKit.getHeaderCells(e,i)[TableKit.getCellIndex(i)]);if(u.hasClassName(o.noEditClass))return;var a=TableKit.getCellData(i);if(a.active)return;a.htmlContent=i.innerHTML;var f=TableKit.Editable.getCellEditor(null,null,u);f.edit(i,r),a.active=!0},getCellEditor:function(e,t,n){var n=n?n:$(TableKit.getHeaderCells(t,e)[TableKit.getCellIndex(e)]),r=TableKit.Editable.types["text-input"];if(n.id&&TableKit.Editable.types[n.id])r=TableKit.Editable.types[n.id];else{var i=$w(n.className).detect(function(e){return TableKit.Editable.types[e]?!0:!1});r=i?TableKit.Editable.types[i]:r}return r},types:{},addCellEditor:function(e){e&&e.name&&(TableKit.Editable.types[e.name]=e)}},TableKit.Editable.CellEditor=Class.create(),TableKit.Editable.CellEditor.prototype={initialize:function(e,t){this.name=e,this.options=Object.extend({element:"input",attributes:{name:"value",type:"text"},selectOptions:[],showSubmit:!0,submitText:"OK",showCancel:!0,cancelText:"Cancel",ajaxURI:null,ajaxOptions:null},t||{})},edit:function(e){e=$(e);if(e.hasClassName("static"))return;var t=this.options,n=e.up("table"),r=$(document.createElement("form"));r.id=e.id+"-form",r.addClassName(TableKit.option("formClassName",n.id)[0]),r.onsubmit=this._submit.bindAsEventListener(this);var i=document.createElement(t.element);$H(t.attributes).each(function(e){i[e.key]=e.value});switch(t.element){case"input":case"textarea":i.value=TableKit.getCellText(e);break;case"select":var s=TableKit.getCellText(e);$A(t.selectOptions).each(function(e){i.options[i.options.length]=new Option(e[0],e[1]),s===e[1]&&(i.options[i.options.length-1].selected="selected")})}r.appendChild(i),t.element==="textarea"&&r.appendChild(document.createElement("br"));if(t.showSubmit){var o=document.createElement("input");o.type="submit",o.value=t.submitText,o.className="editor_ok_button",r.appendChild(o)}if(t.showCancel){var u=document.createElement("a");u.href="#",u.appendChild(document.createTextNode(t.cancelText)),u.onclick=this._cancel.bindAsEventListener(this),u.className="editor_cancel",r.appendChild(u)}e.innerHTML="",e.appendChild(r)},_submit:function(e){var t=Event.findElement(e,"td"),n=Event.findElement(e,"form");Event.stop(e),this.submit(t,n)},submit:function(e,t){if(!n.ajaxURI&&!TableKit.option("editAjaxURI",s.id)[0]){e.update(t);return}var n=this.options;t=t?t:e.down("form");var r=$(TableKit.getHeaderCells(null,e)[TableKit.getCellIndex(e)]),i=e.up("tr"),s=e.up("table"),o="&row="+(TableKit.getRowIndex(i)+1)+"&cell="+(TableKit.getCellIndex(e)+1)+"&id="+i.id+"&field="+r.id+"&"+Form.serialize(t);this.ajax=new Ajax.Updater(e,n.ajaxURI||TableKit.option("editAjaxURI",s.id)[0],Object.extend(n.ajaxOptions||TableKit.option("editAjaxOptions",s.id)[0],{postBody:o,onComplete:function(){var t=TableKit.getCellData(e);t.active=!1,t.refresh=!0}}))},_cancel:function(e){var t=Event.findElement(e,"td");Event.stop(e),this.cancel(t)},cancel:function(e){this.ajax=null;var t=TableKit.getCellData(e);e.innerHTML=t.htmlContent,t.htmlContent="",t.active=!1},ajax:null},TableKit.Editable.textInput=function(e,t){TableKit.Editable.addCellEditor(new TableKit.Editable.CellEditor(e,{element:"input",attributes:Object.extend({name:"value",type:"text"},t||{})}))},TableKit.Editable.textInput("text-input"),TableKit.Editable.multiLineInput=function(e,t){TableKit.Editable.addCellEditor(new TableKit.Editable.CellEditor(e,{element:"textarea",attributes:Object.extend({name:"value",rows:"5",cols:"20"},t||{})}))},TableKit.Editable.multiLineInput("multi-line-input"),TableKit.Editable.selectInput=function(e,t,n){TableKit.Editable.addCellEditor(new TableKit.Editable.CellEditor(e,{element:"select",attributes:Object.extend({name:"value"},t||{}),selectOptions:n}))},Object.extend(TableKit.options||{},{trueResize:!1,keepWidth:!1}),Object.extend(TableKit.Resizable,{resize:function(e,t,n){var r;if(typeof t=="number"){if(!e||e.tagName&&e.tagName!=="TABLE")return;e=$(e),t=Math.min(e.rows[0].cells.length,t),t=Math.max(1,t),t-=1,r=e.tHead&&e.tHead.rows.length>0?$(e.tHead.rows[e.tHead.rows.length-1].cells[t]):$(e.rows[0].cells[t])}else r=$(t),e=e?$(e):r.up("table"),t=TableKit.getCellIndex(r);var i=TableKit.option("trueResize keepWidth minWidth",e.id),s=parseInt(r.getStyle("paddingLeft"),10)+parseInt(r.getStyle("paddingRight"),10);s+=parseInt(r.getStyle("borderLeftWidth"),10)+parseInt(r.getStyle("borderRightWidth"),10),n=Math.max(n-s,i.minWidth);if(!i.trueResize)r.setStyle({width:n+"px"});else{var o=n+s-parseInt(r.getWidth());if(!i.keepWidth){var u=parseInt(e.getWidth())+o;r.setStyle({width:n+"px"}),e.setStyle({width:u+"px"})}else{var a=TableKit.getHeaderCells(e);if(t<0||t>a.length)return;var f;t==a.length-1?f=a[t-1]:f=a[t+1];var l=parseInt(f.getWidth()),c=parseInt(f.getStyle("paddingLeft"),10)+parseInt(f.getStyle("paddingRight"),10),h=l-c-o,p;h<i.minWidth?(p=Math.min(l-c,i.minWidth),n-=p-h):p=h,f.setStyle({width:p+"px"}),r.setStyle({width:n+"px"})}}}}),document.observe("dom:loaded",TableKit.load);var qq=qq||{};qq.extend=function(e,t){for(var n in t)e[n]=t[n]},qq.indexOf=function(e,t,n){if(e.indexOf)return e.indexOf(t,n);n=n||0;var r=e.length;n<0&&(n+=r);for(;n<r;n++)if(n in e&&e[n]===t)return n;return-1},qq.getUniqueId=function(){var e=0;return function(){return e++}}(),qq.attach=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},qq.detach=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.attachEvent&&e.detachEvent("on"+t,n)},qq.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},qq.insertBefore=function(e,t){t.parentNode.insertBefore(e,t)},qq.remove=function(e){e.parentNode.removeChild(e)},qq.contains=function(e,t){return e==t?!0:e.contains?e.contains(t):!!(t.compareDocumentPosition(e)&8)},qq.toElement=function(){var e=document.createElement("div");return function(t){e.innerHTML=t;var n=e.firstChild;return e.removeChild(n),n}}(),qq.css=function(e,t){t.opacity!=null&&typeof e.style.opacity!="string"&&typeof e.filters!="undefined"&&(t.filter="alpha(opacity="+Math.round(100*t.opacity)+")"),qq.extend(e.style,t)},qq.hasClass=function(e,t){var n=new RegExp("(^| )"+t+"( |$)");return n.test(e.className)},qq.addClass=function(e,t){qq.hasClass(e,t)||(e.className+=" "+t)},qq.removeClass=function(e,t){var n=new RegExp("(^| )"+t+"( |$)");e.className=e.className.replace(n," ").replace(/^\s+|\s+$/g,"")},qq.setText=function(e,t){e.innerText=t,e.textContent=t},qq.children=function(e){var t=[],n=e.firstChild;while(n)n.nodeType==1&&t.push(n),n=n.nextSibling;return t},qq.getByClass=function(e,t){if(e.querySelectorAll)return e.querySelectorAll("."+t);var n=[],r=e.getElementsByTagName("*"),i=r.length;for(var s=0;s<i;s++)qq.hasClass(r[s],t)&&n.push(r[s]);return n},qq.obj2url=function(e,t,n){var r=[],i="&",s=function(e,n){var i=t?/\[\]$/.test(t)?t:t+"["+n+"]":n;i!="undefined"&&n!="undefined"&&r.push(typeof e=="object"?qq.obj2url(e,i,!0):Object.prototype.toString.call(e)==="[object Function]"?encodeURIComponent(i)+"="+encodeURIComponent(e()):encodeURIComponent(i)+"="+encodeURIComponent(e))};if(!n&&t)i=/\?/.test(t)?/\?$/.test(t)?"":"&":"?",r.push(t),r.push(qq.obj2url(e));else if(Object.prototype.toString.call(e)==="[object Array]"&&typeof e!="undefined")for(var o=0,u=e.length;o<u;++o)s(e[o],o);else if(typeof e!="undefined"&&e!==null&&typeof e=="object")for(var o in e)s(e[o],o);else r.push(encodeURIComponent(t)+"="+encodeURIComponent(e));return r.join(i).replace(/^&/,"").replace(/%20/g,"+")};var qq=qq||{};qq.FileUploaderBasic=function(e){this._options={debug:!1,action:"/server/upload",params:{},button:null,multiple:!0,maxConnections:3,allowedExtensions:[],sizeLimit:0,minSizeLimit:0,onSubmit:function(e,t){},onProgress:function(e,t,n,r){},onComplete:function(e,t,n){},onCancel:function(e,t){},messages:{typeError:"{file} has invalid extension. Only {extensions} are allowed.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},showMessage:function(e){}},qq.extend(this._options,e),this._filesInProgress=0,this._handler=this._createUploadHandler(),this._options.button&&(this._button=this._createUploadButton(this._options.button)),this._preventLeaveInProgress()},qq.FileUploaderBasic.prototype={setParams:function(e){this._options.params=e},getInProgress:function(){return this._filesInProgress},_createUploadButton:function(e){var t=this;return new qq.UploadButton({element:e,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),onChange:function(e){t._onInputChange(e)}})},_createUploadHandler:function(){var e=this,t;qq.UploadHandlerXhr.isSupported()?t="UploadHandlerXhr":t="UploadHandlerForm";var n=new qq[t]({debug:this._options.debug,action:this._options.action,maxConnections:this._options.maxConnections,onProgress:function(t,n,r,i){e._onProgress(t,n,r,i),e._options.onProgress(t,n,r,i)},onComplete:function(t,n,r){e._onComplete(t,n,r),e._options.onComplete(t,n,r)},onCancel:function(t,n){e._onCancel(t,n),e._options.onCancel(t,n)}});return n},_preventLeaveInProgress:function(){var e=this;qq.attach(window,"beforeunload",function(t){if(!e._filesInProgress)return;var t=t||window.event;return t.returnValue=e._options.messages.onLeave,e._options.messages.onLeave})},_onSubmit:function(e,t){this._filesInProgress++},_onProgress:function(e,t,n,r){},_onComplete:function(e,t,n){this._filesInProgress--,n.error&&this._options.showMessage(n.error)},_onCancel:function(e,t){this._filesInProgress--},_onInputChange:function(e){this._handler instanceof qq.UploadHandlerXhr?this._uploadFileList(e.files):this._validateFile(e)&&this._uploadFile(e),this._button.reset()},_uploadFileList:function(e){for(var t=0;t<e.length;t++)if(!this._validateFile(e[t]))return;for(var t=0;t<e.length;t++)this._uploadFile(e[t])},_uploadFile:function(e){var t=this._handler.add(e),n=this._handler.getName(t);this._options.onSubmit(t,n)!==!1&&(this._onSubmit(t,n),this._handler.upload(t,this._options.params))},_validateFile:function(e){var t,n;return e.value?t=e.value.replace(/.*(\/|\\)/,""):(t=e.fileName!=null?e.fileName:e.name,n=e.fileSize!=null?e.fileSize:e.size),this._isAllowedExtension(t)?n===0?(this._error("emptyError",t),!1):n&&this._options.sizeLimit&&n>this._options.sizeLimit?(this._error("sizeError",t),!1):n&&n<this._options.minSizeLimit?(this._error("minSizeError",t),!1):!0:(this._error("typeError",t),!1)},_error:function(e,t){function r(e,t){n=n.replace(e,t)}var n=this._options.messages[e];r("{file}",this._formatFileName(t)),r("{extensions}",this._options.allowedExtensions.join(", ")),r("{sizeLimit}",this._formatSize(this._options.sizeLimit)),r("{minSizeLimit}",this._formatSize(this._options.minSizeLimit)),this._options.showMessage(n)},_formatFileName:function(e){return e.length>33&&(e=e.slice(0,19)+"..."+e.slice(-13)),e},_isAllowedExtension:function(e){var t=-1!==e.indexOf(".")?e.replace(/.*[.]/,"").toLowerCase():"",n=this._options.allowedExtensions;if(!n.length)return!0;for(var r=0;r<n.length;r++)if(n[r].toLowerCase()==t)return!0;return!1},_formatSize:function(e){var t=-1;do e/=1024,t++;while(e>99);return Math.max(e,.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][t]}},qq.FileUploader=function(e){qq.FileUploaderBasic.apply(this,arguments),qq.extend(this._options,{element:null,listElement:null,template:'<div class="qq-uploader"><div class="qq-upload-drop-area"><span>Drop files here to upload</span></div><div class="qq-upload-button">Upload a file</div><ul class="qq-upload-list"></ul></div>',fileTemplate:'<li><span class="qq-upload-file"></span><span class="qq-upload-spinner"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">Cancel</a><span class="qq-upload-failed-text">Failed</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",list:"qq-upload-list",file:"qq-upload-file",spinner:"qq-upload-spinner",size:"qq-upload-size",cancel:"qq-upload-cancel",success:"qq-upload-success",fail:"qq-upload-fail"}}),qq.extend(this._options,e),this._element=this._options.element,this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._classes=this._options.classes,this._button=this._createUploadButton(this._find(this._element,"button")),this._bindCancelEvent(),this._setupDragDrop()},qq.extend(qq.FileUploader.prototype,qq.FileUploaderBasic.prototype),qq.extend(qq.FileUploader.prototype,{_find:function(e,t){var n=qq.getByClass(e,this._options.classes[t])[0];if(!n)throw new Error("element not found "+t);return n},_setupDragDrop:function(){var e=this,t=this._find(this._element,"drop"),n=new qq.UploadDropZone({element:t,onEnter:function(n){qq.addClass(t,e._classes.dropActive),n.stopPropagation()},onLeave:function(e){e.stopPropagation()},onLeaveNotDescendants:function(n){qq.removeClass(t,e._classes.dropActive)},onDrop:function(n){t.style.display="none",qq.removeClass(t,e._classes.dropActive),e._uploadFileList(n.dataTransfer.files)}});t.style.display="none",qq.attach(document,"dragenter",function(e){if(!n._isValidFileDrag(e))return;t.style.display="block"}),qq.attach(document,"dragleave",function(e){if(!n._isValidFileDrag(e))return;var r=document.elementFromPoint(e.clientX,e.clientY);if(!r||r.nodeName=="HTML")t.style.display="none"})},_onSubmit:function(e,t){qq.FileUploaderBasic.prototype._onSubmit.apply(this,arguments),this._addToList(e,t)},_onProgress:function(e,t,n,r){qq.FileUploaderBasic.prototype._onProgress.apply(this,arguments);var i=this._getItemByFileId(e),s=this._find(i,"size");s.style.display="inline";var o;n!=r?o=Math.round(n/r*100)+"% from "+this._formatSize(r):o=this._formatSize(r),qq.setText(s,o)},_onComplete:function(e,t,n){qq.FileUploaderBasic.prototype._onComplete.apply(this,arguments);var r=this._getItemByFileId(e);n.success?Notifications.Display(2,"File "+t+" successfully uploaded"):n.error&&Notifications.Display(5,n.error),qq.remove(r)},_addToList:function(e,t){var n=qq.toElement(this._options.fileTemplate);n.qqFileId=e;var r=this._find(n,"file");qq.setText(r,this._formatFileName(t)),this._find(n,"size").style.display="none",this._listElement.appendChild(n)},_getItemByFileId:function(e){var t=this._listElement.firstChild;while(t){if(t.qqFileId==e)return t;t=t.nextSibling}},_bindCancelEvent:function(){var e=this,t=this._listElement;qq.attach(t,"click",function(t){t=t||window.event;var n=t.target||t.srcElement;if(qq.hasClass(n,e._classes.cancel)){qq.preventDefault(t);var r=n.parentNode;e._handler.cancel(r.qqFileId),qq.remove(r)}})}}),qq.UploadDropZone=function(e){this._options={element:null,onEnter:function(e){},onLeave:function(e){},onLeaveNotDescendants:function(e){},onDrop:function(e){}},qq.extend(this._options,e),this._element=this._options.element,this._disableDropOutside(),this._attachEvents()},qq.UploadDropZone.prototype={_disableDropOutside:function(e){qq.UploadDropZone.dropOutsideDisabled||(qq.attach(document,"dragover",function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="none",e.preventDefault())}),qq.UploadDropZone.dropOutsideDisabled=!0)},_attachEvents:function(){var e=this;qq.attach(e._element,"dragover",function(t){if(!e._isValidFileDrag(t))return;var n=t.dataTransfer.effectAllowed;n=="move"||n=="linkMove"?t.dataTransfer.dropEffect="move":t.dataTransfer.dropEffect="copy",t.stopPropagation(),t.preventDefault()}),qq.attach(e._element,"dragenter",function(t){if(!e._isValidFileDrag(t))return;e._options.onEnter(t)}),qq.attach(e._element,"dragleave",function(t){if(!e._isValidFileDrag(t))return;e._options.onLeave(t);var n=document.elementFromPoint(t.clientX,t.clientY);if(qq.contains(this,n))return;e._options.onLeaveNotDescendants(t)}),qq.attach(e._element,"drop",function(t){if(!e._isValidFileDrag(t))return;t.preventDefault(),e._options.onDrop(t)})},_isValidFileDrag:function(e){var t=e.dataTransfer,n=navigator.userAgent.indexOf("AppleWebKit")>-1;return t&&t.effectAllowed!="none"&&(t.files||!n&&t.types.contains&&t.types.contains("Files"))}},qq.UploadButton=function(e){this._options={element:null,multiple:!1,name:"file",onChange:function(e){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"},qq.extend(this._options,e),this._element=this._options.element,qq.css(this._element,{position:"relative",overflow:"hidden",direction:"ltr"}),this._input=this._createInput()},qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){this._input.parentNode&&qq.remove(this._input),qq.removeClass(this._element,this._options.focusClass),this._input=this._createInput()},_createInput:function(){var e=document.createElement("input");this._options.multiple&&e.setAttribute("multiple","multiple"),e.setAttribute("type","file"),e.setAttribute("name",this._options.name),qq.css(e,{position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),this._element.appendChild(e);var t=this;return qq.attach(e,"change",function(){t._options.onChange(e)}),qq.attach(e,"mouseover",function(){qq.addClass(t._element,t._options.hoverClass)}),qq.attach(e,"mouseout",function(){qq.removeClass(t._element,t._options.hoverClass)}),qq.attach(e,"focus",function(){qq.addClass(t._element,t._options.focusClass)}),qq.attach(e,"blur",function(){qq.removeClass(t._element,t._options.focusClass)}),window.attachEvent&&e.setAttribute("tabIndex","-1"),e}},qq.UploadHandlerAbstract=function(e){this._options={debug:!1,action:"/upload.php",maxConnections:999,onProgress:function(e,t,n,r){},onComplete:function(e,t,n){},onCancel:function(e,t){}},qq.extend(this._options,e),this._queue=[],this._params=[]},qq.UploadHandlerAbstract.prototype={log:function(e){this._options.debug&&window.console&&console.log("[uploader] "+e)},add:function(e){},upload:function(e,t){var n=this._queue.push(e),r={};qq.extend(r,t),this._params[e]=r,n<=this._options.maxConnections&&this._upload(e,this._params[e])},cancel:function(e){this._cancel(e),this._dequeue(e)},cancelAll:function(){for(var e=0;e<this._queue.length;e++)this._cancel(this._queue[e]);this._queue=[]},getName:function(e){},getSize:function(e){},getQueue:function(){return this._queue},_upload:function(e){},_cancel:function(e){},_dequeue:function(e){var t=qq.indexOf(this._queue,e);this._queue.splice(t,1);var n=this._options.maxConnections;if(this._queue.length>=n){var r=this._queue[n-1];this._upload(r,this._params[r])}}},qq.UploadHandlerForm=function(e){qq.UploadHandlerAbstract.apply(this,arguments),this._inputs={}},qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerForm.prototype,{add:function(e){e.setAttribute("name","qqfile");var t="qq-upload-handler-iframe"+qq.getUniqueId();return this._inputs[t]=e,e.parentNode&&qq.remove(e),t},getName:function(e){return this._inputs[e].value.replace(/.*(\/|\\)/,"")},_cancel:function(e){this._options.onCancel(e,this.getName(e)),delete this._inputs[e];var t=document.getElementById(e);t&&(t.setAttribute("src","javascript:false;"),qq.remove(t))},_upload:function(e,t){var n=this._inputs[e];if(!n)throw new Error("file with passed id was not added, or already uploaded or cancelled");var r=this.getName(e),i=this._createIframe(e),s=this._createForm(i,t);s.appendChild(n);var o=this;return this._attachLoadEvent(i,function(){o.log("iframe loaded");var t=o._getIframeContentJSON(i);o._options.onComplete(e,r,t),o._dequeue(e),delete o._inputs[e],setTimeout(function(){qq.remove(i)},1)}),s.submit(),qq.remove(s),e},_attachLoadEvent:function(e,t){qq.attach(e,"load",function(){if(!e.parentNode)return;if(e.contentDocument&&e.contentDocument.body&&e.contentDocument.body.innerHTML=="false")return;t()})},_getIframeContentJSON:function(iframe){var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response;this.log("converting iframe's innerHTML to JSON"),this.log("innerHTML = "+doc.body.innerHTML);try{response=eval("("+doc.body.innerHTML+")")}catch(err){response={}}return response},_createIframe:function(e){var t=qq.toElement('<iframe src="javascript:false;" name="'+e+'" />');return t.setAttribute("id",e),t.style.display="none",document.body.appendChild(t),t},_createForm:function(e,t){var n=qq.toElement('<form method="post" enctype="multipart/form-data"></form>'),r=qq.obj2url(t,this._options.action);return n.setAttribute("action",r),n.setAttribute("target",e.name),n.style.display="none",document.body.appendChild(n),n}}),qq.UploadHandlerXhr=function(e){qq.UploadHandlerAbstract.apply(this,arguments),this._files=[],this._xhrs=[],this._loaded=[]},qq.UploadHandlerXhr.isSupported=function(){var e=document.createElement("input");return e.type="file","multiple"in e&&typeof File!="undefined"&&typeof (new XMLHttpRequest).upload!="undefined"},qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerXhr.prototype,{add:function(e){if(e instanceof File)return this._files.push(e)-1;throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)")},getName:function(e){var t=this._files[e];return t.fileName!=null?t.fileName:t.name},getSize:function(e){var t=this._files[e];return t.fileSize!=null?t.fileSize:t.size},getLoaded:function(e){return this._loaded[e]||0},_upload:function(e,t){var n=this._files[e],r=this.getName(e),i=this.getSize(e);this._loaded[e]=0;var s=this._xhrs[e]=new XMLHttpRequest,o=this;s.upload.onprogress=function(t){t.lengthComputable&&(o._loaded[e]=t.loaded,o._options.onProgress(e,r,t.loaded,t.total))},s.onreadystatechange=function(){s.readyState==4&&o._onComplete(e,s)},t=t||{},t.qqfile=r;var u=qq.obj2url(t,this._options.action);s.open("POST",u,!0),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("X-File-Name",encodeURIComponent(r)),s.setRequestHeader("Content-Type","application/octet-stream"),s.send(n)},_onComplete:function(id,xhr){if(!this._files[id])return;var name=this.getName(id),size=this.getSize(id);this._options.onProgress(id,name,size,size);if(xhr.status==200){this.log("xhr - server response received"),this.log("responseText = "+xhr.responseText);var response;try{response=eval("("+xhr.responseText+")")}catch(err){response={}}this._options.onComplete(id,name,response)}else this._options.onComplete(id,name,{});this._files[id]=null,this._xhrs[id]=null,this._dequeue(id)},_cancel:function(e){this._options.onCancel(e,this.getName(e)),this._files[e]=null,this._xhrs[e]&&(this._xhrs[e].abort(),this._xhrs[e]=null)}}),Sound.prototype.loadSound=function(e,t){return Sound.__call("loadSound",this.object_id,e,t)},Sound.prototype.start=function(){return Sound.__call("start",this.object_id)},Sound.prototype.stop=function(){return Sound.__call("stop",this.object_id)},Sound.prototype.getId3=function(){return Sound.__call("id3",this.object_id)},Sound.prototype.getPan=function(){return Sound.__call("getPan",this.object_id)},Sound.prototype.getTransform=function(){return Sound.__call("getTransform",this.object_id)},Sound.prototype.getVolume=function(){return Sound.__call("getVolume",this.object_id)},Sound.prototype.setPan=function(e){return Sound.__call("setPan",this.object_id,e)},Sound.prototype.setTransform=function(e){return Sound.__call("setTransform",this.object_id,e)},Sound.prototype.setVolume=function(e){return Sound.__call("setVolume",this.object_id,e)},Sound.prototype.start=function(e,t){return Sound.__call("start",this.object_id,e,t)},Sound.prototype.getDuration=function(){return Sound.__call("getDuration",this.object_id)},Sound.prototype.setDuration=function(e){return Sound.__call("setDuration",this.object_id,e)},Sound.prototype.getPosition=function(){return Sound.__call("getPosition",this.object_id)},Sound.prototype.setPosition=function(e){return Sound.__call("setPosition",this.object_id,e)},Sound.prototype.getBytesLoaded=function(){return Sound.__call("getBytesLoaded",this.object_id)},Sound.prototype.getBytesTotal=function(){return Sound.__call("getBytesTotal",this.object_id)},Sound.prototype.onLoad=function(e){Sound.trace("Sound:onLoad("+e+") event triggered")},Sound.onLoad=function(e,t){Sound.instances[e].onLoad(t)},Sound.prototype.onSoundComplete=function(){Sound.trace("Sound:onSoundComplete() event triggered")},Sound.onSoundComplete=function(e){Sound.instances[e].onSoundComplete},Sound.prototype.onID3=function(){Sound.trace("Sound:onID3() event triggered")},Sound.onID3=function(e){Sound.instances[e].onID3()},Sound.trace=function(e,t){document.getElementById("sound_tracer")!=undefined&&(t==undefined||t==1?document.getElementById("sound_tracer").value+="Javascript: "+e+"\n":document.getElementById("sound_tracer").value+=e+"\n")},Sound.__thisMovie=function(e){return navigator.appName.indexOf("Microsoft")!=-1?window[e]:document[e]},Sound.__call=function(){Sound.trace("Sound.__call "+arguments[0]+" on object_id "+arguments[1]);var e=arguments[0],t=arguments[1],n=new Array;if(arguments.length>1)for(var r=2;r<arguments.length;r++)n.push(arguments[r]);return Sound.__thisMovie(t).proxyMethods(e,n)};